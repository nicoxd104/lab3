CREATE DATABASE "laboratorio 2 bda"
    WITH
    OWNER = postgres
    ENCODING = 'UTF8'
    LC_COLLATE = 'Spanish_Latin America.1252'
    LC_CTYPE = 'Spanish_Latin America.1252'
    TABLESPACE = pg_default
    CONNECTION LIMIT = -1
    IS_TEMPLATE = False;

CREATE EXTENSION postgis;

create table parametros_trigger (
    id_usuario INTEGER,
    tipo_operacion VARCHAR(10),
    descripcion VARCHAR(200)
);

CREATE TABLE regiones_chile (
    id SERIAL PRIMARY KEY,
    nombre VARCHAR(100),
    geometria GEOMETRY(MULTIPOLYGON, 4326)
);

create table auditoria (
    id SERIAL PRIMARY KEY,
    id_usuario INTEGER,
    tipo_operacion VARCHAR(10) ,
    descripcion varchar(200),
    fecha DATE ,
    hora TIME 
);

create table voluntario(
	id serial primary key,
	nombre varchar(200),
	correo varchar(200),
    numero_documento varchar(200),
	zona_vivienda GEOMETRY(point, 4326), 
	contrasena varchar(200),
    equipamiento varchar(200)
);

create table institucion (
	id serial primary key,
	nombre varchar(200)

);


create table emergencia(
	id serial primary key,
	tipo_emergencia varchar(200),
	zona_emergencia GEOMETRY(point, 4326),
	condicion_fisica varchar(200),
	cantidad_voluntario_minimo integer,
	cantidad_voluntario_maximo integer,
    id_institucion integer,
    FOREIGN KEY (id_institucion) REFERENCES institucion(id)

);

create table habilidad(
	id serial primary key,
	nombre varchar(200)	
);

create table tarea(
	id serial primary key,
	id_emergencia integer,
	nombre varchar(200),
	descripcion varchar(500),
	tipo varchar(200),
    FOREIGN KEY (id_emergencia) REFERENCES emergencia(id)
);


create table estado_tarea(
	id serial primary key,
	estado boolean,
    id_tarea integer,
    FOREIGN KEY (id_tarea) REFERENCES tarea(id)

);


create table ranking (
	id serial primary key,
	id_tarea integer,
	id_voluntario integer,
	nivel integer,
	tarea_ranking varchar(200),
    nombre_voluntario varchar(200),
	FOREIGN KEY (id_tarea) REFERENCES tarea(id),
	FOREIGN KEY (id_voluntario) REFERENCES voluntario(id)
);

create table voluntario_habilidad(
	id serial primary key,
	id_voluntario integer,
	id_habilidad integer,
	FOREIGN KEY (id_voluntario) REFERENCES voluntario(id),
	FOREIGN KEY (id_habilidad) REFERENCES habilidad(id)
);



create table emergencia_habilidad(
	id serial primary key,
	id_habilidad integer,
	id_emergencia integer,
	FOREIGN KEY (id_habilidad) REFERENCES habilidad(id),
	FOREIGN KEY (id_emergencia) REFERENCES emergencia(id)
);

create table tarea_habilidad(
	id serial primary key,
	id_tarea integer,
	id_emergencia_habilidad integer,
	habilidad_requerida varchar(200),
	FOREIGN KEY (id_tarea) REFERENCES tarea(id),
	FOREIGN KEY (id_emergencia_habilidad) REFERENCES emergencia_habilidad(id)
);




CREATE  FUNCTION auditar_operacion()
RETURNS TRIGGER AS $$
DECLARE
    id_usuario INTEGER;
    tipo_operacion VARCHAR(10);
    descripcion VARCHAR(200);
BEGIN

    SELECT id_usuario, tipo_operacion, descripcion INTO id_usuario, tipo_operacion, descripcion
    FROM parametros_trigger
    WHERE id = 1; 

   
    INSERT INTO auditoria (id_usuario, tipo_operacion, descripcion, fecha, hora)
    VALUES (id_usuario, TG_OP, descripcion, current_date, current_time);

    
    DELETE FROM parametros_trigger WHERE id = 1;

    RETURN NEW;
END;
$$ LANGUAGE plpgsql;



CREATE TRIGGER trigger_auditoria
AFTER INSERT OR UPDATE OR DELETE ON emergencia
FOR EACH ROW
EXECUTE FUNCTION auditar_operacion();


CREATE TRIGGER trigger_auditoria
AFTER INSERT OR UPDATE OR DELETE ON emergencia_habilidad
FOR EACH ROW
EXECUTE FUNCTION auditar_operacion();


CREATE TRIGGER trigger_auditoria
AFTER INSERT OR UPDATE OR DELETE ON estado_tarea
FOR EACH ROW
EXECUTE FUNCTION auditar_operacion();


CREATE TRIGGER trigger_auditoria
AFTER INSERT OR UPDATE OR DELETE ON habilidad
FOR EACH ROW
EXECUTE FUNCTION auditar_operacion();


CREATE TRIGGER trigger_auditoria
AFTER INSERT OR UPDATE OR DELETE ON institucion
FOR EACH ROW
EXECUTE FUNCTION auditar_operacion();


CREATE TRIGGER trigger_auditoria
AFTER INSERT OR UPDATE OR DELETE ON ranking
FOR EACH ROW
EXECUTE FUNCTION auditar_operacion();



CREATE TRIGGER trigger_auditoria
AFTER INSERT OR UPDATE OR DELETE ON tarea
FOR EACH ROW
EXECUTE FUNCTION auditar_operacion();


CREATE TRIGGER trigger_auditoria
AFTER INSERT OR UPDATE OR DELETE ON tarea_habilidad
FOR EACH ROW
EXECUTE FUNCTION auditar_operacion();


CREATE TRIGGER trigger_auditoria
AFTER INSERT OR UPDATE OR DELETE ON voluntario
FOR EACH ROW
EXECUTE FUNCTION auditar_operacion();


CREATE TRIGGER trigger_auditoria
AFTER INSERT OR UPDATE OR DELETE ON voluntario_habilidad
FOR EACH ROW
EXECUTE FUNCTION auditar_operacion();




CREATE FUNCTION public.mayores_consultas()
    RETURNS integer[]
    LANGUAGE 'plpgsql'
    
AS $BODY$
declare id_usuario_actualizaciones INTEGER;
declare    id_usuario_inserts INTEGER;
declare    id_usuario_deletes INTEGER;
declare    resultado INTEGER[];

Begin
 
     SELECT id_usuario INTO id_usuario_actualizaciones
    FROM (
        SELECT id_usuario, COUNT(*) AS num_actualizaciones
        FROM auditoria
        WHERE tipo_operacion = 'UPDATE'
        GROUP BY id_usuario
        ORDER BY COUNT(*) DESC
        LIMIT 1
    ) AS t1;
    

    SELECT id_usuario INTO id_usuario_inserts
    FROM (
        SELECT id_usuario, COUNT(*) AS num_inserts
        FROM auditoria
        WHERE tipo_operacion = 'INSERT'
        GROUP BY id_usuario
        ORDER BY COUNT(*) DESC
        LIMIT 1
    ) AS t2;
    
    
    SELECT id_usuario INTO id_usuario_deletes
    FROM (
        SELECT id_usuario, COUNT(*) AS num_deletes
        FROM auditoria
        WHERE tipo_operacion = 'DELETE'
        GROUP BY id_usuario
        ORDER BY COUNT(*) DESC
        LIMIT 1
    ) AS t3;

 
    resultado := ARRAY[id_usuario_actualizaciones, id_usuario_inserts, id_usuario_deletes];

  
    RETURN resultado;

end;
$BODY$;

ALTER FUNCTION public.mayores_consultas()
    OWNER TO postgres;

 
INSERT INTO regiones_chile (nombre, geometria) VALUES
    ('Arica y Parinacota', 'MULTIPOLYGON(((-69.47185735170855 -17.511519026451815,-69.78899653932056 -17.667713245841824,-69.75728262055935 -17.954554662560653,-70.33870446451472 -18.37641969446693,-70.24120137398215 -19.183349960536294,-69.87315940932376 -19.03801813578545,-69.41448024441367 -19.027632409570167,-69.2991238077297 -19.11589035636366,-68.95580107950359 -18.941925422060837,-69.10411649419389 -18.066796168478305,-69.47185735170855 -17.511519026451815)))');

;
 insert into regiones_chile (nombre, geometria) VALUES
 ('Tarapac√°', 'MULTIPOLYGON(((-70.2851467043557 -19.23003660576828, -69.94457055795539 -19.058787657550265,-69.79900172118752 -19.04840323079217,-69.46941190209044 -19.040614484224562,-69.31560331984515 -19.128865516880744,-69.145315246645 -19.102914214086955, -68.95030793701257 -18.941925440441807,-68.87340364588992 -19.063979627131065, -68.42845739010889 -19.411469350853864,-68.7003689781266 -19.7349523824635,-68.53557406857807 -19.843496367922643, -68.58226595961682 -20.034559891034863,-68.77727326924925 -20.07068099622419,-68.78001985107505 -20.130004747959873,-68.71135530542982 -20.142898239551315,-68.71410188725565 -20.256315015512605, -68.69212923264917 -20.336172597854013,-68.75255403281697 -20.372223805594444,-68.74980744462246 -20.45459492536283,-68.46690951656413 -20.63976831040029, -68.56303987307157 -20.73483938904865,-68.4943753066768 -20.95301950383581,-68.54106719771553 -21.065835180455647,-68.85967068950937 -21.26049703117654,-69.31011013112969 -21.37819395587282,-69.55180933426615 -21.608196644946602,-69.76604271667925 -21.42166673656994, -70.05168722656337 -21.416552963111275,-70.1340847193443 -20.20219459648012, -70.2851467043557 -19.23003660576828 )))')

;
INSERT INTO regiones_chile (nombre, geometria) VALUES
    ('Antofagasta', 'MULTIPOLYGON(((-70.05774401847184 -21.466280733381904,-70.142888059797 -21.645094845804135,-70.30768297612512 -22.763946089202285, -70.57135483140279 -23.095317581098165,-70.62079331289588 -23.519088153973982,-70.4944505466488 -23.461151873858825,-70.58234117041624 -24.722306132464567, -70.6290330651529 -25.518075563818023,-70.74002901703362 -25.819943858288507,-70.65359913891318 -26.05945578370623, -70.6218493877669 -26.056286626332298, -70.52483625926438 -26.00556845656783, -70.29906025111302 -25.891372505276312,-70.26201887477569 -25.93103642721596,-70.07328424296168 -25.961172082343623,-70.02036799105122 -25.91993187380366,-69.91321281455596 -25.890177422635748, -69.85500493745444 -25.940945366042186,-69.50752154990903 -25.947289821625894,-69.4404942974891 -25.860023619463057,-69.37346702316779 -25.87589500063631,-69.11417738880648 -25.79334054991536,-68.98717838422135 -25.376520748410943,-68.77904112670683 -25.40042359132392,-68.5515012434918 -25.29681045574673,-68.44037704798421 -25.124457384942616, -68.41039116781157 -25.142023019587008,-68.35041941564636 -25.11008362194631, -68.57619542379771 -24.79023188489552,-68.49505716941701 -24.601131029706654,-68.25517016075621 -24.40050021595862,-67.3308995765914 -24.030506941637498,-66.99752715512018 -22.998624544237178,-67.18097016174315 -22.816651018908928,-67.56902267957943 -22.90116909579817,-67.8018541879855 -22.884919702197607,-67.88652019104225 -22.831282906018696,-67.87417306559648 -22.68326593139812, -67.84595106457756 -22.535088960364337,-67.92356160550904 -22.270907985539687,-67.94825585640058 -22.099412338480217,-68.07349099040782 -21.984965888156506,-68.06819936521678 -21.772177726252885,-68.18637899527509 -21.606639359974388,-68.18814287033878 -21.302934564089295,-68.41215502308489 -20.93930650467244,-68.47918227550481 -20.94754321810511,-68.53209852741529 -21.067747541857663,-68.86017933095188 -21.301291196710554,-69.30996747219089 -21.403144927097575,-69.55514615974062 -21.627956936202796,-69.76681116738249 -21.424492373773155, -70.05774401847184 -21.466280733381904 )))')
;
INSERT INTO regiones_chile (nombre, geometria) VALUES
    ('Atacama', 'MULTIPOLYGON(((-70.6536656711909 -26.067172520577756,-70.66954054795146 -26.29352968450846,-70.62367980276055 -26.33305740913946,-70.69070705518048 -26.3946937025429,-70.87238618673976 -27.14273657051562,-70.93235793890497 -27.114479759588168,-70.96410771617455 -27.183539370529903,-70.95881609098352 -27.368533521626922,-70.88649721337255 -27.48595419146704, -70.91617337586874 -27.64518490157658,-70.99731162879813 -27.692050080109123, -71.03082527361111 -27.663933394799187,-71.19133792089819 -28.30256528735095,-71.30775368288542 -28.57089691549053,-71.4788495783117 -28.853996052349423,-71.51589096111384 -28.98522906434596,-71.48943283515861 -29.17021595957424,-71.41733040580812 -29.18734802337166,-71.3933277707667 -29.179751548644475,-71.3882272108204 -29.16377092122956,-71.37082530041536 -29.14542943098279, -71.35252329119629 -29.14045046137988,-71.32372012914658 -29.155648665337296,-71.31891960213831 -29.154862606480602,-71.28471584720427 -29.18079937170412,-71.28081541901005 -29.183680829940123,-71.26221337685296 -29.17660801526164,-71.2445114335099 -29.1755601494002,-71.22950978660901 -29.1815852319763,-71.19980652574526 -29.184990556929783,-71.18150450510316 -29.282910698400155,-71.1719034510866 -29.2844808461545,-71.15630173830968 -29.29677950197118,-71.13049890564014 -29.29991934697341, -71.1043960400326 -29.295732865514807,-71.09629515070613 -29.302012523333417,-71.08339373437136 -29.30776853703513,-71.0899944513326 -29.313000995860566,-71.0830936937582 -29.34282088304143,-71.09329481365079 -29.35458949045863,-71.06089125634487 -29.35511250812842,-71.02038680971248 -29.335235949222803, -71.01648638151825 -29.325296216222334,-71.00838549219176 -29.318494788085353,-71.01138582157195 -29.318494788085353,-71.00808545925376 -29.282387311215782,-70.99248374647684 -29.271395545041624, -70.99038351128765 -29.2556909701074,-70.97208150206855 -29.19415817771388,-70.97508183144872 -29.17975154874055,-70.90664968799975 -29.129774643081,-70.86644527430536 -29.143140088682053,-70.80103809381751 -29.13658861681969, -70.78423624928851 -29.11666957813387,-70.73383071570153 -29.105135739764968,-70.71672883489063 -29.084161811746867,-70.72903018534936 -29.064757126345174,-70.66182280723339 -29.049807783224935,-70.6519217202788 -29.055053413574043,-70.6468211603325 -29.053742030998105,-70.6468211603325 -29.043250370147064, -70.61021712447922 -29.03669253976514,-70.59521547757834 -29.051381499806332,-70.55471103094594 -29.044824186761694,-70.53373869020662 -29.06059610990048,-70.53913928309093 -29.102024979505217,-70.52563780088013 -29.108578653458263,-70.53103839376446 -29.12849925910909,-70.51483661098217 -29.134789176294305,-70.48933380828832 -29.17409243099708,-70.48513334773953 -29.22385495161429,-70.46683133852046 -29.234066375042445,-70.46143074563615 -29.261815353885282,-70.47606533827084 -29.288037301015716,-70.44349287601128 -29.330804767397204,-70.47381895864119 -29.359850299050496,-70.4416208955723 -29.387908900285545, -70.3936981970512 -29.396064019229467,-70.3820919185031 -29.374533089971802,-70.29672960484535 -29.375838124931843,-70.19002671329812 -29.517986476112128,-70.1312465283933 -29.52906306603046,-70.10129482974767 -29.522221785720742,-70.088565362953 -29.53297216083825,-70.00133107580128 -29.505605322751872,-70.00133107580128 -29.499088318176753,-69.95415716944454 -29.499088318176753,-69.94704364015833 -29.488660237104988,-69.98073928693988 -29.45345754476849,-69.96838421622739 -29.41400297926813,-70.02154846057137 -29.385299124127066,-69.99833590280306 -29.303383416174448,-69.93730934140508 -29.24590527172358,-69.95260175749726 -29.188556692111415,-69.92519160666477 -29.186037756190647,-69.87734406266769 -29.138586247303103,-69.79030481177854 -29.132915795601285,-69.77010785018875 -28.99105294169357,-69.75640277045623 -28.983481441615275,-69.76626080933522 -28.899316406840413, -69.74918957344421 -28.883106792818115,-69.74486165489171 -28.850679977581798,-69.72803085686996 -28.84478310464705,-69.69917806651998 -28.779052503883914,-69.69412882838856 -28.771465534448485,-69.73139701592397 -28.73731735150068, -69.70206334582468 -28.63881539058187,-69.66287163583941 -28.5816122654136, -69.66984439350733 -28.55479418265641,-69.65157095961901 -28.538319846978123,-69.66647823285281 -28.482330106085378,-69.6809046280278 -28.471128592848565, -69.63329752305114 -28.43011669848963,-69.65637975533113 -28.41108516255763,-69.62367992533267 -28.37618512983283,-69.604444731766 -28.391627167084067,-69.58376689868184 -28.353123656580806,-69.52774439569248 -28.33153865698211, -69.50033423919488 -28.283485715669293,-69.47653068715613 -28.236470227456184,-69.45609329231904 -28.183288111459984,-69.39237671362946 -28.223547925394058,-69.38372087228008 -28.183076176862826,-69.30942493027668 -28.128595247510358,-69.30100952981824 -28.07154078258617,-69.26069986735224 -28.040789819427257,-69.26840720179507 -28.009323217514655, -69.2574242454868 -28.008472639800143,-69.24355104348972 -27.97954904868527,-69.2364217591301 -27.96627562753551,-69.17360698342101 -27.970359931059903,-69.12254588517074 -27.897840572549654,-69.13237273658535 -27.870931355018048,-69.1113702466111 -27.85202277841061,-69.08458725877362 -27.715135583673213,-69.04489448639305 -27.69824715716464,-69.04258228499377  -27.68016170076558,-69.06050183757336 -27.66360917867769,-69.03930666690431 -27.594300291159904,-68.973601637594 -27.543571187552516,-68.98824557303537 -27.525118429137933, -68.94701133376623 -27.528023235447748,-68.9497088962237 -27.48820361967266,-68.98940166860429 -27.451789395078283,-68.96935700140114 -27.427765532735762,-68.93478539762049 -27.443096168830813,-68.93094937240811 -27.40860799533974,-68.88776317965304 -27.398061690725733,-68.86942411511961 -27.316169702078792,-68.81123764736857 -27.299291809798408,-68.86605794903355 -27.264032242554926,-68.84465880020116 -27.16053968384859,-68.80809948079136 -27.15122611108384,-68.7793417125247 -27.09844776582576,-68.75137726286016 -27.111424014950806, -68.66997956500167 -27.098390560529296,-68.61891846976356 -27.168182175463237,-68.6035038008779 -27.15721046011978,-68.57537203016156 -27.1752103640224, -68.55552564058432 -27.13492084423124,-68.55803052427824 -27.113655838882803,-68.53741340464366 -27.111254697210143, -68.49213281479203 -27.134577892355427,-68.48192059665529 -27.127890120513385,-68.47382788861547 -27.110568646538947, -68.48404010675222 -27.057215394330083,-68.45109125200912 -27.094102186452023,-68.294439669903 -27.037308642413283,-68.26534447990231 -26.92123015502884,-68.58873903401775 -26.492484848788134,-68.55827390829319 -26.28613574436904,-68.38196862040338 -26.177073843157874, -68.4789533221256 -25.703005509887053,-68.5467778659864 -25.62867375288635,-68.51652657645347 -25.573589778000866,-68.53964858384637 -25.509090214985616,-68.5641868477305 -25.504720563636607,-68.59096983491933 -25.414429285857633,-68.57150880859089 -25.416343675122082, -68.52526479998824 -25.37491644521963,-68.51909893240511 -25.341659943175436,-68.54568923623289 -25.300032907661965,-68.5562868270297 -25.302645903872374, -68.57786736346962 -25.286270197980965,-68.63644310523516 -25.31361987282502,-68.66052853364177 -25.305781425420435,-68.68191638672063 -25.36951941506378,-68.72546283028603 -25.391106089293114,-68.74819946689239 -25.381357746770444,-68.78211173844085 -25.40381256815309,-68.826043544765 -25.371608617289237,-68.95692835759442 -25.39075434269095,-68.98432856995655 -25.378113609686014,-69.01231176208674 -25.45025333419255,-68.99423928383598 -25.50603983229152,-69.08226974738336 -25.58336125250665,-69.05020566936092 -25.63277871896319,-69.09334642389499 -25.721048357741893,-69.06244831670283 -25.732077464490416,-69.09567836821533 -25.801379833685957,-69.3696804578235 -25.882705904593923,-69.4285617848359 -25.85962547810019,-69.50085169783891 -25.917318087513785,-69.50318363051642 -25.950347513554103,-69.76086219138199 -25.91941546918127,-69.85355651531326 -25.948774893737102,-69.9083569634978 -25.897391100632742,-70.07243050802693 -25.96271122903525, -70.25480704928933 -25.93215366921792,-70.3035163118625 -25.900569196515406,-70.32277347641673 -25.933172383797956,-70.38960711576134 -25.932153670722922,-70.52440716799876 -26.010568787619246,-70.60370131637369 -26.009550744644375,-70.6195601460487 -26.06349485359684, -70.6536656711909 -26.067172520577756 )))')
;
INSERT INTO regiones_chile (nombre, geometria) VALUES
 ('Coquimbo', 'MULTIPOLYGON(((-71.45086564475717 -29.24590838528194, -71.3322067473167 -29.34421796347239,-71.32924027488069 -29.406259422558655,-71.33097449410592 -29.495880731751097,-71.28525232373853 -29.605261036026047,-71.33478467496985 -29.77076285451397,-71.26810650985078 -29.92773671833461,-71.41479847311277 -30.00035669514856,-71.36717122727566  -30.160263061956016,-71.4605206584424 -30.181674154035367,-71.5119581001057 -30.290304812478027,-71.59671572160605 -30.302828417685486,-71.62725600863206 -30.243753551308497, -71.7066443461562 -30.720031997012008,-71.64252301950047 -31.00703210544891,-71.6593167010799 -31.076359465010444,-71.53718083338778 -31.735686819871823,-71.50206675943583 -31.77463160301607,-71.55702789989729 -31.849878342145566, -71.51122694951275 -31.86154906456083,-71.51557960865507 -31.952649945541086,-71.49233380981033 -31.96510619341875,-71.54004887059689 -32.177639147280864, -71.50823883007251 -32.174532472703916,-71.47887571574233 -32.154854406252056,-71.33940092267392 -32.201453464316074,-71.28801547259609 -32.18695853509343,-71.22439539154733 -32.12688352846379,-71.18035072005205 -32.16935444624018,-71.03598205427927 -32.06365848965226,-71.04087590666764 -32.03358534389161,-70.95278656367705 -32.0470676312506,-70.93076422792942 -32.0729895253145,-70.73745705858899 -32.019063737282195,-70.68851853470534 -32.05951105709731,-70.65670849418096 -32.05432650197516,-70.54170294575823 -32.17453247159646,-70.5331387040786 -32.147603519920466,-70.44749628728219 -32.18281670161526,-70.44994321347639 -32.219051344464866,-70.41568624675783 -32.278031146938325,-70.35696001809744 -32.25216752853951, -70.32392651447597 -32.270790076772876,-70.30435110492252 -32.207664868932596,-70.31046842040796  -32.13828010577942,-70.33983153473817 -32.072989525173355,-70.39366391101018 -32.03980818463648,-70.37408850145671 -32.02425028949388,-70.28722262156323 -32.04603060257581,-70.21626176193195 -31.963030268322008,-70.28355223227196 -31.887226936736226,-70.4621778444473 -31.844625072796862,-70.47046044534882 -31.701185296447086,-70.51163963576069 -31.690340413342952,-70.51262009267525 -31.654459848609342, -70.56850613680565 -31.594349738659567,-70.45869496024723 -31.086049300769524,-70.39986752652548 -31.16242728782502, -70.31848960261634 -31.040697040198594,-70.27142767071705 -31.039016911852233,-70.3282941683885 -30.930586040350015,-70.1233786709703 -30.432251343338088,-70.15671419733847 -30.340907787718606,-70.06160987662537 -30.389127522675132,-69.90081494263617 -30.351061286505146,-69.88022534743024 -30.21220570728122,-69.83708524318922 -30.21390025102797,-69.81355427723959 -30.14948708096381,-69.94983778836458 -30.11132786224334,-69.96258372253371 -30.06806291667607,-69.88120579569106 -29.86165862443346, -69.894932192495 -29.69656777297649,-69.95572052963198  -29.50219619038312,-70.19201064604292  -29.521820827516454,-70.30182182047457 -29.379242494831914,-70.40575025341882 -29.40145348136452,-70.47830406509686 -29.361299312174776,-70.46849951861236 -29.239030767990965,-70.55085789943611 -29.047211434850947,-70.72537923022925 -29.063495714691772,-70.72930109096251 -29.108050065289163,-70.89892013718281  -29.13460213915897,-70.96853257811716 -29.179125702482107,-71.04696913128262 -29.356172104173197,-71.09599197701104 -29.34933543016895,-71.08912877860907 -29.30830575487221,-71.18227218549306 -29.286074457032523,-71.20188132378442 -29.185973767877055,-71.27835696312074 -29.186829743909804,-71.36169580085904 -29.148303752841873,-71.3911095082961 -29.183405796922013, -71.45086564475717 -29.24590838528194      )))')

;
INSERT INTO regiones_chile (nombre, geometria) VALUES
    ('Valparaiso ', 'MULTIPOLYGON(((-71.53984077907437 -32.17982760088613, -71.51912974127649 -32.23177535085037,-71.46969126841192 -32.342066324644165,-71.4010267227667 -32.40353874543959,-71.47106456939133 -32.51941049132179,-71.44085216930743 -32.65710341579666,-71.50265026038814 -32.71489443310328,-71.49166393852913 -32.77149333354286,-71.53560924774206 -32.76571958364902,-71.50814342948398 -32.91802091593454,-71.54796886595821 -32.93185352738443,-71.550708224006 -33.00117361290275,-71.64185140044165 -33.023575034680604,-71.66228004343586 -33.1091750286956,-71.73456601095378  -33.10127697951945,-71.6449942641281  -33.340534951207644,-71.69685158865184 -33.42320241214104,-71.62456562183915 -33.55687819735702,-71.65128000113924 -33.69688471599103,-71.7879947657927 -33.771374673142105,-71.83836931426946 -33.9224928590698,-71.81378465268068 -33.910301873931864,-71.7784631241362 -33.93374965666292,-71.74919671477075  -33.919514272493984,-71.75222427141635 -33.93626153787232,-71.72194867552108 -33.953946675416255,-71.584595429766  -33.86717728108152,-71.55737493504401  -33.87202043794672,-71.55219007890648 -33.76648510607088,-71.52043282090865 -33.77564383662302,-71.48560070303036 -33.7694073560317,-71.47490874434067  -33.78340485448035,-71.44229827033713 -33.78451566908662,-71.36371237396794  -33.758296602469386,-71.35970288945931  -33.74696215005249,-71.39204605883738 -33.73673763166578,-71.39097686296842 -33.72873498589622,-71.42465653284093  -33.69960794862421,-71.42144894523403 -33.68737609528007,-71.43882337810477 -33.683372565142676,-71.41877595024317 -33.65756756318605,-71.40006502253624 -33.662239731895006,-71.38322518759998 -33.62374239848114,-71.35542609500679 -33.62151659288502,-71.33564596671238 -33.606824832844325,-71.331903781171 -33.54290882986615,-71.33537866774515 -33.54090373006928,-71.33270567807273 -33.5357793748087,-71.34901091663404 -33.53110034848849,-71.35302040114269  -33.49254446527507,-71.33992275174782 -33.475155269587084,-71.33805165897712 -33.4425968813363,-71.34313033935473  -33.415827409657325,-71.32831470779561  -33.40673544123269,-71.28231596006846 -33.405798875661326,-71.1992938300243 -33.31115376805716,-71.21948838432274 -33.23611433888883,-71.00071385244965 -33.193876331539954,-70.99286040771575 -33.176975421210344,-71.02203034529883 -32.980498605651526,-70.72920904879176 -32.92401276459076,-70.70789255594258 -32.95602583995984,-70.60018817102045  -32.94284538895398,-70.50706875488983  -33.085842193493995, -70.43302199025587 -33.01907649521871, -70.39783331736842 -33.037552527445314,-70.37315106249044 -33.10524402086666,-70.34061536287854  -33.09490563568226,-70.27217820162593 -33.12967536915555,-70.26432475689202  -33.18133466735802,-70.24525210539538 -33.18321261386312,-70.09491473477489  -33.04883805906373,-70.08947277408895 -33.02702094050464,-70.03176652090666 -33.00994338836186, -69.99782166609353  -32.90455876451655,-70.19470182400963  -32.62482573066206,-70.13699557082731  -32.567629475073346,-70.15396799823388 -32.46744823729729, -70.24901359171061 -32.42161392691353,-70.22525219334142 -32.32987542387237,-70.31011433037422 -32.281101484472195,-70.36103161259388  -32.26101046885875,-70.42552683673881  -32.289710557751725,-70.46286617703325 -32.1777288937277,-70.53075588665946 -32.1547412456553,-70.65295736398669 -32.134622296318696,-70.6597463349493 -32.068485934131154,-70.72763604457555  -32.0310833358992,-70.92451620249162   -32.082867477691934,-71.03653422337489 -32.03683857669084,-71.03313973789359 -32.07999134996943,-71.1858915845526 -32.169109205442155,-71.22323092484703 -32.1403710205366,-71.34543240217425  -32.206455295216806,-71.4778173359454 -32.160488701440464, -71.53984077907437 -32.17982760088613 )))')
;

INSERT INTO regiones_chile (nombre, geometria) VALUES
    ('Magallanes y la Ant√°rtica Chilena', 'MULTIPOLYGON(((-73.99728952672196 -48.71465202681092, -74.04131055220127 -48.7320763048276, -74.16897152609127 -48.703032487701094,-74.33625142291267 -48.708842592644366, -75.01417521529412 -48.615800408372365,-75.69209900767557 -48.83069987451093,-75.63046957200451 -49.85172992282715,-75.52922124052414 -50.66226890131222,-75.3179203358161 -51.609661854658505,-74.75445117596162 -52.74070913463622,-74.31424088085194 -53.31784325914342,-73.49544980693669 -54.08399391806637,-73.08605416405645 -54.48743273620666,-67.88792455038565 -55.8904838444031,-67.2946627674196 -55.979713747099375,-67.05296357877896 -55.90588297777577,-66.78770032872806 -55.81904568327405,-66.42232581724976 -55.210907692132096,-67.09144540453534 -54.923548330763865,-68.61017078357169 -54.867855288563916,-68.60371539879905 -52.66658995429606,-68.42110791859054 -52.32720156721768,-69.9778571010987 -52.00190669151082,-72.03926663386382 -51.954488701717594,-71.92807043994452 -51.91229720783235,-72.33008806666635 -51.589281498694326,-72.27021310098438 -51.25860005784225,-72.28732023403636 -50.63889123390001,-72.49260583066028 -50.59004337167513,-72.73210569338816 -50.60633162877,-73.19399828579196 -50.806756880848994,-73.151230453162 -50.6443156431149, -73.3479624832599  -50.51939577517784,-73.36506961631189 -50.29042564669235,-73.45060528157187 -49.790523537059336, -73.61312311535755  -49.7794781413404,-73.60456954883156  -49.16250803553642,-73.23676618821372 -49.15691440692106, -73.99728952672196 -48.71465202681092 )))')
;

INSERT INTO regiones_chile (nombre, geometria) VALUES
    ('Aysen', 'MULTIPOLYGON(((-73.25048121380111 -49.15821981686333, -74.01952411852145 -48.725257134098854,-74.25023698993753 -48.71800925621532,-74.55785415182567 -48.696259355770685,-74.92040294976525 -48.60916573565258,-75.00829356744758 -48.60190114258526,-75.60155523680326 -48.775963037795314,-75.667473200065  -46.73030314431085,-75.08519785791961 -45.865002561627456,-75.22802011165338 -44.81481681409085,-74.10741469321246 -43.79275350130059,-72.8110280823982  -43.63393392089746,-72.75609644634673 -43.75308806594573,-72.51439724772035 -43.784822518911774,-72.34960233956599 -43.665731507754145,-72.1079031409396 -43.88784320198699,-72.03099885046758 -43.94324220361692,-71.85521761510292 -43.91159194652381,-71.74535434300002 -44.06178066900447,-71.81127230626176 -44.3924281554905,-71.39379187227073 -44.384577182056525,-71.11913369201346 -44.44735548339866,-71.09716103759288 -44.58053558569911, -71.19603798248549 -44.611827847291536,-71.22899696411638  -44.79143132477971,-72.04198517767786 -44.80702268709262,-72.05297150488815 -44.884916301756355,-71.53661412600451 -44.97824960475093,-71.31688758179868  -45.295993985851695,-71.48168248995306 -45.5042734019557,-71.73436801578971 -45.558146442183826,-71.62450474368683 -45.979639256978324,-71.7673269974206 -46.21580462137813,-71.80817146506192 -46.26341043848519,-71.78619881064134 -46.33172580608273,-72.80792724119836 -46.747357178181176,-72.78595458677776 -46.867670843813684,-71.87408942832366 -46.468100875442566,-71.66534921132813  -46.528602613098954,-71.65436288411786  -46.664485413079824,-71.86310310111337 -47.23445795882774,-72.5112964065205 -47.938395662578685,-72.22565189905296 -48.319702997475886, -72.46735109767934  -48.52385028006279,-72.59918702420283  -48.48017345061692,-72.54425538815138  -48.78512123028183,-72.80792724119836 -48.980186333599065,-73.10455807587618  -49.16730806612526, -73.25048121380111 -49.15821981686333  )))')
;
INSERT INTO regiones_chile (nombre, geometria) VALUES
    ('Los lagos', 'MULTIPOLYGON(((-73.69741108030917 -40.244468467140905,-73.6181732311727 -40.29149355624744,-73.44208912198056 -40.26462608011563,-73.34524286192489 -40.33848594659806,-73.07231249267707 -40.33848594659806,-72.90503258894455 -40.43237259571774,-72.56166857601988 -40.66651638215514,-72.02461204298386  -40.633117399201105,-71.87494055017055 -40.56626929175132,-71.82159682166615 -40.58315095839462,-71.98007251993907  -40.72341931410421,-71.86561784896418 -40.95654426651655, -71.81279261620654 -41.062842489507325,-71.72475056161048  -42.11637680292986,-71.9096388762622  -42.188175110681335,-72.16496083459081  -42.15554961276168,-72.00648510992883  -42.49403193161948,-72.13854819182293 -42.90167508816868,-71.72475053522142 -43.184790368269304,-71.73355474068102 -43.30664070868836,-71.91844305533274  -43.39626918948573,-71.5662748369485 -43.65162107969207,-71.70655509695293 -43.86892491092887,-71.74047985022948 -44.06019897478688,-71.83094585896696  -43.954463902852574,-72.11930626181761 -43.94632262913241,-72.06841913190279 -43.89745156847039,-72.18715576837072 -43.889302488747965,-72.28327590265427 -43.83222770873251,-72.32850890702301 -43.685213123341505,-72.48722487976946 -43.789792401406,-73.0594982346439  -43.738925884951186,-74.76751409380762 -43.688016118436686,-74.83794773748447  -43.57968927682707,-74.40654166996374 -43.24712471388489,-74.01915662974105  -41.7739932119246,-73.86068093146812 -41.45805183269196,-73.93991878060459 -40.98124057819999,-73.82546410962969 -40.661436936631695, -73.69741108030917 -40.244468467140905 )))');  